---
layout: post
title: 一次面试经历（下）
excerpt: "面试结束了差不多快两个星期了，一直想把这个坑填上，趁今天下班早，赶紧把这剩下的一块拼图补上吧，说不定过久了就变质了。"
modified: 2017-10-26 01:22:00 +08:00
categories: articles
tags: [面试, 随笔]
comments: true
share: true
---

面试结束了差不多快两个星期了，一直想把这个坑填上，趁今天下班早，赶紧把这剩下的一块拼图补上吧，说不定过久了就变质了。

上次说到知乎第一轮面试过了，第二轮的面试官过了几分钟就来了，是个身材略胖，穿白色风衣的人，也是抱着本mac进来了。

没有自我介绍，直接就项目问起来了，问了下我的第一个项目是什么（一个HTTP服务器），然后问我知不知道HTTP的几个状态码是什么含义（2xx成功，3xxx重定向，4xx请求有问题，5xx服务器有问题），又问我清不清楚HTTP控制缓存的几个头，我说出了Etag和Last-modify，不过关于Cache-Control的几个字段没说清楚(public, private, no-cache, no-store)，勉强答出来，毕竟之前只是接触过，并没有深刻理解。然后面试官又问了我了不了解HTTP2.0，这个就完全不知道了，只能凭着自己模糊的印象（臆想？）乱说一通，后来下面搜了一下，是八竿子都打不着-_-

还问了一道系统设计题，关于生成短链接的，不过我之前在准备面试时在网上见过这题，还简单看过答案，所以在刚听到问题时，心里一阵窃喜，强忍住没笑出来。我开始说的哈希法，然后用一个哈希表储存哈希后的短链接和长链接的映射关系，这应该是大多数人的第一想法，然后面试官很快说了碰撞问题，长链接有无穷多个，而哈希会有固定长度，肯定会出现碰撞。这时候很自然的一个想法是用一个自增长序列，像数据库的自增长主键一样，这样碰撞问题就完美解决了，而且可以有限利用空间。不过面试官又发难了，链接总不能以像1234这样的数字给用户吧，一般是字母数字的组合。这是我始料未及的，因为我印象里那个答案没有这个（其实有的），不过这个问题也简单，做一个映射就是，1->a, 2->b, 26->z, 27->A...，面试官说不错，可以看成一个62进制的数。然后面试官问了设计的最后一个问题，从长链接到短链接有一个重定向，是该用301还是302，看我不清楚301 302的含义，就说是永久重定向还是临时的。当时我对短链接的理解有点偏差，答的临时重定向，这个问题的详细答案可以看这里[短 URL 系统是怎么设计的？ - 知乎](https://www.zhihu.com/question/29270034)

到这里感觉还是不错的。后面面试官问的都是一些比较宏观、顶层的问题，比如，你解决的最困难的问题是什么，你觉得C#最大的三个缺点是什么（当时主要围绕着生态答的），你觉得C#和Java有哪些区别，你觉得该不该写注释（我开始是直接说的可以不写，好的代码是自解释的，我看过的有的开源项目就没有注释，后来觉得自己答得太嚣张了，赶紧补充说公司规范里类和函数都是要加注释的，对外接口是需要注释，最好是能输出一个API文档给使用者参考），你最看重的同事三个素养是什么（强调了沟通），你最近在学什么，看什么书，能不能给我简单讲一下内容，你通过什么获取业界最新动态，云云。

总的来说这次面试还是比较轻松，小胖子面试官虽然有点高冷，全程一张扑克脸，但也还不错（嗯，过程有反馈，这点非常重要，比如对你的回答点点头，或者给你问题提示，告诉你介绍问题答案等等），虽然最后结果有点遗憾，没有通过第二轮，而是转推荐了另外一个部门（当然这是后话了），但是这次面试经历还是很nice的。

知乎的第三个面试（还是第二轮）是通过电话进行的，因为那时我已经回上海了。刚接到HR面试电话是非常激动的，根据网上看到的情报，还有从知乎第一轮面试官套的话，这应该是最后一轮面试了，所以就决定直接电话面了。虽然这不是这次面试挂掉的根本原因，但是影响还是非常大的，没准备，在察觉之后的措手不及，以及电话通话的表达不畅语无伦次，失利后的心态落差等等，这次面试的失利确实让我反思了很多......

先是hr小姐姐微信告诉我面试官拿走了简历，要我准备下，然后电话来了。一个年轻男性的声音，比较有磁性，吐词清晰，说话有条不紊（和我形成了鲜明对比啊）。一开始让我自我介绍（汗，面这么多场第一次自我介绍，都快忘了自我介绍是什么了），没什么准备，只好凭着印象把简历复述了遍（我自己都感觉烂，因为毫无准备），然后问我第二个项目做的什么，又是一顿乱答（内心活动：啊啊啊这和写好的剧本不一样啊），我说到用户管理，他就问我权限系统是怎么设计的，我说我们的系统权限分两部分，用户自己的和用户所属区域的（可以理解为一个组），有两张表分别记录，最后的权限是两个权限的并集，然后面试官说不是这样的吧，可能是我表述有点混乱，又或者我们的系统的权限设计有点另类，于是我又说了一种网上比较通用的权限方案，用户+角色+权限的模式，每个用户有一个角色，而角色和权限是多对多的关系，用一张关系表记录。我说权限实际是对应一个url或按钮，他说这有问题，用户可以绕开权限直接访问url什么（但是controller里的每个action是有拦截器的，不可能直接访问），不过我当时没怎么懂他的意思，也可能我没表述清楚，反正我到最后也没弄清他说的这个问题是什么。

后来由用户引申到缓存设计，问我这个系统用了什么缓存，像用户这种经常访问的数据，应该放在缓存里吧，你觉得该怎么设计性能最好。我当时说的是在数据库和应用层中间放一个缓存层，查询先查缓存，查不到就查数据库，查到后设置一个过期时间放入缓存，写的时候也是先检查缓存，如果有就在更新数据库的同时更新缓存（这里在并发时可能会出现数据不一致的问题，所以一般要加锁或者加版本号控制），没有就直接更新缓存。面试官表示还不满意，然后我又说写的时候可以用写回，先更新缓存，至于数据库可以由一个队列异步更新，当时这可能存在数据丢失的风险，如果缓存突然宕机，还没来得及写入数据库，这部分数据就会永久丢失了。面试官还是不满意（嗯，没给任何提示和说明），我绞尽脑汁，说可以利用redis的数据结构来存数据，而不是将对象整个序列化存储，这样可以减小修改的开销。可以说到这里我的回答已经非常勉强了，面试官也不和我死磕了，说我们换一个话题吧。

后面问的是MVC是什么，你做了HTTP服务器，你说说HTTP协议是什么，这个项目有没有投入实用（没有），你说喜欢算法，工作内容是处理些业务逻辑能不能接受（我的想法是工作和兴趣是分开的），你项目里提到了消息队列，你用过其它什么消息队列没有，我答了zookeeper，他说zookeeper不是（后来在网上无意看到了kafka，rabbitmq这些框架，之前确实完全没了解），他还问如果同事有事找你你会怎么处理，我说我性格很好都会帮忙的，他说如果你忙呢，我说如果事情花时间不多我还是还立马处理了，他接着问如果你特别忙没时间了，我说我会说明情况，现在很忙，忙完有时间立马帮你处理，然后面试官表示我一直只是在强调自己性格好（怪我不作为咯），没看出什么，但是这就是我一直以来的做法啊，我不是领导理解不了您的太忙连帮别人忙的时间都没有的境遇啊，确实怪我，怪我不是领导遇不到这种事情很多需要协调的情景，我从来是有忙必帮。这时我已经有点莫名其妙加小小的不爽了，全程只听到他在问，却从听不到他对自己问题的解释。

到这里面试就差不多结束了，他说有没有什么想问，我问了下工作的具体内容，他简单答了下，我说不太明白，他又详细解释了下，他说还有什么想问的吗，我说没了。本来面试到这里已经结束了，不过面试官在这时候说，最后再问你一个问题（第二次最后一个问题），看你项目里有网站开发项目经验，你对前端了解多少，我说目前重心在后端，对前端只是停留在Jquery和Bootstrap阶段，可以看懂代码。可以听得出他对我还抱有最后一丝期望吧，不过在我回答完后就没了。hr小姐姐面试完后问我感觉怎么样，我说感觉基本没戏吧，面试官很嫌弃的样子-_-

面试完后我就直接从公司下班了，没有坐车走回了宿舍。

反思了好久，有三个教训。一是自己的迷之自信，想当然地以为第三面是hr面，很蠢；二是没好好准备，自我介绍，项目介绍这种完全没预演，等到面试时临场说，效果很差，很多东西没说到。三是，为什么在提问环节没把面试官怼回去，面试是对等的，他问了我整场的问题却没给任何一丁点的解释或者作答，我难道不该把这些问题还给他听听他的答案吗？

然后就是今日头条的面试，和知乎的低调而略显文艺范比，今日头条则显得大气多了，大楼前张扬的LOGO，门口成群来面试的人，漂亮的前台姐姐。

我是到5楼面试的，领了一张狗牌。

第一个面试官是三十好几的大叔模样，和在知乎的面试经历还是差别蛮大的。一来就开门见山的说我们招Go后台开发，负责大流量的广告线业务（想着自己经历写的Python后端工程师，惴惴不安）。不过开始还聊起了家常，为什么想来头条云云，不过也可能是第二个面试官问的，记不清了。主要就聊了第一个项目，问如果要使一个HTTP服务器流量尽可能大，该怎么做。我第一个答的异步事件驱动模型，而非传统的多线程模型，这也是为什么现在的高性能服务器用Nginx而不是Apache的原因。他说还有，我想说负载均衡的，但他说只考虑单机的情况，还问我你觉得这里的流量是什么（没实际高并发项目经验并不清楚...），我又试着答了个epoll，但是觉得这个太基本了本来不大愿意答的，但是想不到面试官却点头表示了认同，还问我epoll和select的区别。然后提示我可以试着从一个请求进来的具体流程着手考虑，虽然我做过一个完整的HTTP服务器，但是我分不清这些过程哪些属于优化的范畴，最后就直接坦言不是很清楚了。

后面他又问我假如多个进程往一个socket里写会发生什么，我说是不是考虑线程安全，他说不光线程，进程安全也有。我说我没做过多进程写的尝试，不知道会发生什么。然后他又问你觉得哪里会不安全，我说write有个用户态向内核态的数据拷贝过程，如果这个拷贝过程被线程/进程切换打断，那写入的数据是乱序的，那么就不安全，如果不被打断，那么就是安全的。他又接着问我，你知道哪些操作系统原语，表示第一次听说这个概念，知道原语是一个基本操作，而且也不可再分割，概念上和原子操作有点像，但操作系统原语是第一次听说，然后就顿住了......回去要补操作系统原理了，这一块还是需要系统的学习。

面试官还问我会不会C++（大概想看我的编程基础吧，转go有没有难度），出了一道算法题，写一个优先队列出来，我用python写了个最大堆出来，包括`create`, `sift_down`, `pop`, `push`方法，不过堆的写法还是有点复杂所以不保证100%正确性，不过面试官直接拿着我的答题纸出去了。

本想着没戏，基本等着被hr通知可以回去等消息了，不过来了第二个面试官，也是个大叔，不过非常好说话！一来就坐我旁边的座位靠上来了，也是说我们招Go后台开发，你报的python后端工程师有没有问题。先是基本考了几个python题，数组的切片操作，列表表达式之类的，不过马上出了一道算法题，2个括号有一种排列方式`()`，4个括号有两种`()()`, `(())`，6个括号有`()()()`, `()(())`, `(())()`, `((()))`，要我写出20个括号的所以排列。我的第一想法是动态规划，然后就开始找状态转移方程了，可以看出`f(n+2)`是`f(n)`的所有排列再左边加一个括号，右边加一个括号，放在一个括号中间的三种情况，再做一个去重操作。面试官问了我思路，我简单说了下，但这种方法好像不是他的菜，他直接说了自己的思路，用一个决策树，列举出20括号排列的所有情况，然后想办法排除一些情况。基本上就是个回溯法+剪枝的过程了，不过在怎么写回溯上还是花了点时间，面试官在剪枝函数上给了很大提示，最后总算写出来了，面试官检查了下表示通过了。然后面试官说我人很聪明，但是在经验上有欠缺，需要商量下再决定面试结果。

最后结果是没通过。不过那个面试官倒是安慰我好久，大概是看我一脸的生无可恋。说我人很聪明，但是工作经验上还有专业上还是和我们岗位要求有一定差距，今日头条的广告业务是公司比较核心的业务，在要求上还是比较高的，你可以过几年再来。

总的来说这次面试，结果很伤感，也很开心，特别第二个面试官，他本不必对一个陌生人的我说这么多可有可无的话，真的非常谢谢他。

这次跳槽尝试也算是告一段落啦，总结来说就是，能力不足，经验有限，好好静下心来慢慢沉淀吧！机会永远留给有准备的人，stay hungry stay foolish。